<div>


  <mat-accordion>
    <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Notification Preferences
        </mat-panel-title>
        <mat-panel-description>
          Add custom notifications or edit existing ones
        </mat-panel-description>
      </mat-expansion-panel-header>

      <mat-card>
        <mat-card-title>
          Standard Notifications
        </mat-card-title>
        <mat-card-content>
          <div class="results-table-div">
            <div class="mat-table">
              <div class="mat-header-row">
                <div class="mat-header-cell"></div>
                <div class="mat-header-cell" style="font-weight: bold;"><span class="headerText"></span></div>
                <div class="mat-header-cell" id="headerWithIcon" style="font-weight: bold;">
                  <mat-icon class="icon">email</mat-icon><span class="headerText"> Email me all <mat-slide-toggle
                      id="emailAllStandard" (change)="emailAllStandardNotifications()"
                      [checked]="emailAllStandardChecked">
                    </mat-slide-toggle></span>
                </div>
              </div>
              <div class="mat-row">
                <div class="mat-header-cell">Your Events</div>
                <div class="mat-cell">
                  <mat-checkbox>new</mat-checkbox> &nbsp; &nbsp; <mat-checkbox>updated</mat-checkbox>
                </div>
                <div class="mat-cell">
                  <mat-slide-toggle [checked]="yourEventsChecked" (change)="yourEvents()"></mat-slide-toggle>
                  <span class="text-small text-italic">{{yourEventsChecked === true ? ' Send email ' :
                              yourEventsChecked === false ? ' Do not email' : ' Do not email ' }}</span>
                </div>
              </div>
              <div class="mat-row">
                <div class="mat-header-cell">Your Organization Events</div>
                <div class="mat-cell">
                  <mat-checkbox>new</mat-checkbox> &nbsp; &nbsp; <mat-checkbox>updated</mat-checkbox>
                </div>
                <div class="mat-cell">
                  <mat-slide-toggle [checked]="yourOrgEventsChecked" (change)="yourOrgEvents()"></mat-slide-toggle><span
                    class="text-small text-italic">{{yourOrgEventsChecked === true ? ' Send email ' :
                        yourOrgEventsChecked === false ? ' Do not email ' : ' Do not email ' }}</span>
                </div>
              </div>
              <div class="mat-row">
                <div class="mat-header-cell">Your Collaboration Events</div>
                <div class="mat-cell">
                  <mat-checkbox>new</mat-checkbox> &nbsp; &nbsp; <mat-checkbox>updated</mat-checkbox>
                </div>
                <div class="mat-cell">
                  <mat-slide-toggle [checked]="yourCollabEventsChecked" (change)="yourCollabEvents()">
                  </mat-slide-toggle>
                  <span class="text-small text-italic">{{yourCollabEventsChecked === true ? ' Send email ' :
                            yourCollabEventsChecked === false ? ' Do not email ' : ' Do not email ' }}</span>
                </div>
              </div>
              <div class="mat-row">
                <div class="mat-header-cell">All Events*</div>
                <div class="mat-cell">
                  <mat-checkbox>new</mat-checkbox> &nbsp; &nbsp; <mat-checkbox>updated</mat-checkbox>
                </div>
                <div class="mat-cell">
                  <mat-slide-toggle [checked]="allEventsChecked" (change)="allEvents()"></mat-slide-toggle>
                  <span class="text-small text-italic">{{allEventsChecked === true ? ' Send email ' :
                            allEventsChecked === false ? ' Do not email ' : ' Do not email ' }}</span>
                </div>
              </div>
            </div>
            <div class="warning">
              <p>* Beware that selecting this option will create notifications for all events that you have permission
                to view,
                regardless of ownership,
                diagnosis, species, location, or any other detail. Consider a Custom Notification (below) to specify
                events
                pertaining to your specific interest.</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-divider style="margin: 25px auto;" [inset]="true"></mat-divider>
      <mat-card>
        <mat-card-title>
          Custom Notifications
          <button mat-button color="accent" (click)="newCustomNotification()">
            <mat-icon>add_alert</mat-icon>Add New Custom Notification
          </button>
        </mat-card-title>
        <mat-card-content>
          <div class="results-table-div">
            <div class="mat-table">
              <div class="mat-header-row">
                <div class="mat-header-cell" style="font-weight: bold;">Cue</div>
                <div class="mat-header-cell" style="font-weight: bold;"><span class="headerText"></span></div>
                <div class="mat-header-cell" id="headerWithIcon" style="font-weight: bold;">
                  <mat-icon class="icon">email</mat-icon><span class="headerText"> Email me all <mat-slide-toggle><span
                        class="text-small text-italic">{{emailAllCustom === true ? ' On ' :
                        emailAllCustom === false ? ' Off ' : ' Off ' }}</span></mat-slide-toggle></span>
                </div>
                <div class="mat-header-cell" id="headerWithIcon" style="font-weight: bold;"><span
                    class="headerText"></span></div>
              </div>
              <div class="mat-row" *ngFor="let cue of dummy_custom_cues">
                <div class="mat-header-cell">{{cue.name}}</div>
                <div class="mat-cell">
                  <mat-checkbox>new</mat-checkbox> &nbsp; &nbsp; <mat-checkbox>updated</mat-checkbox>
                </div>
                <div class="mat-cell">
                  <mat-slide-toggle><span class="text-small text-italic">{{emailCustom === true ? ' On ' :
                      emailCustom === false ? ' Off ' : ' Off ' }}</span></mat-slide-toggle>
                </div>
                <div class="mat-cell">
                  <mat-icon class="icon" color="warn" (click)="deleteWarning(cue)">delete</mat-icon>
                </div>
              </div>
            </div>

          </div>
        </mat-card-content>
      </mat-card>

    </mat-expansion-panel>
  </mat-accordion>

  <mat-card>
    <mat-card-title>
      Notifications
    </mat-card-title>
    <mat-card-title>

      <div class="results-card-title-row">
        <span class="results-button-row">
          <button mat-button color="accent">
            <i class="material-icons">
              check_circle_outline
            </i> Mark as Read</button>
          <button mat-button color="warn" [disabled]="selection.selected.length === 0">
            <i class="material-icons">
              remove_circle
            </i> Delete</button>
        </span>

      </div>
    </mat-card-title>
    <div class="results-table-div">

      <mat-table [dataSource]="notificationsDataSource" matSort matSortActive="read" matSortDirection="desc"
        *ngIf="notificationsDataSource.data.length > 0">

        <!-- Selection column -->
        <ng-container matColumnDef="select">
          <mat-header-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
              [indeterminate]="selection.hasValue() && !isAllSelected()">
            </mat-checkbox>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)">
            </mat-checkbox>
          </mat-cell>
        </ng-container>

         <!-- Go-to Column -->
         <ng-container matColumnDef="go">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Event </mat-header-cell>
          <mat-cell *matCellDef="let notification"> 
            <button mat-stroked-button color="primary" (click)="$event.stopPropagation()" matTooltip="Click to go to event details page">{{notification.event}}</button>
          </mat-cell>
        </ng-container>

        <!-- Message Column -->
        <ng-container matColumnDef="read">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Message </mat-header-cell>
          <mat-cell *matCellDef="let notification"
            [ngStyle]="{'font-weight':notification.read === true ? 'bold' : 'normal' }"> {{notification.subject}}
          </mat-cell>
        </ng-container>

        <!-- Source -->
        <ng-container matColumnDef="created_date">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Date </mat-header-cell>
          <mat-cell *matCellDef="let notification"> {{notification.created_date}} </mat-cell>
        </ng-container>

        <!-- Date -->
        <ng-container matColumnDef="source">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Source </mat-header-cell>
          <mat-cell *matCellDef="let notification"> {{notification.source}} </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="notificationDisplayedColumns"></mat-header-row>
        <mat-row *matRowDef="let notification; columns: notificationDisplayedColumns;" (click)="openNotification(notification)"
          matTooltip="Click to view full notification text"></mat-row>
      </mat-table>

      <div *ngIf="notificationsDataSource.data.length === 0 && notificationsLoading === false">
        <h3>No notifications</h3>
      </div>

      <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50]"></mat-paginator>
    </div>
  </mat-card>
</div>